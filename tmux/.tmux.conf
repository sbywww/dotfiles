# ---- 색상 ----
set -g default-terminal "xterm-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
# ---- Prefix 키 변경 ----
# Ctrl+b → Ctrl+a (더 누르기 편함)
unbind C-b
set -g prefix C-a
bind C-a send-prefix

# ---- 기본 설정 ----
set -g mouse on                    # 마우스 사용 (스크롤, 패인 선택, 리사이즈)
set -g base-index 1                # 윈도우 번호 1부터 시작
setw -g pane-base-index 1          # 패인 번호 1부터 시작
set -g renumber-windows on         # 윈도우 닫으면 번호 재정렬
set -g escape-time 10               # ESC 지연 제거
set -g repeat-time 0
set -s extended-keys always           # Shift+Enter 등 modifier 키 전달
set -as terminal-features 'xterm*:extkeys'
set -as terminal-features 'tmux*:extkeys'
set -s extended-keys-format csi-u
set -g history-limit 10000         # 스크롤백 버퍼 크기
setw -g automatic-rename on           # 현재 프로그램명 자동 표시 (zsh, vim 등)
setw -g allow-rename off              # 외부 프로그램이 윈도우 이름 덮어쓰기 방지

# ---- 패인 분할 ----
# | 로 세로 분할, - 로 가로 분할 (직관적)
bind \\ split-window -h -c "#{pane_current_path}"
bind - split-window -v -c "#{pane_current_path}"
unbind '"'
unbind %

# ---- 패인 이동 (Vim 스타일) ----
bind -r h select-pane -L
bind -r j select-pane -D
bind -r k select-pane -U
bind -r l select-pane -R

# ---- 패인 리사이즈 (Vim 스타일) ----
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ---- 윈도우 이동 (순서 변경) ----
bind-key -n C-S-Left swap-window -t -1 \; previous-window
bind-key -n C-S-Right swap-window -t +1 \; next-window

# ---- 새 윈도우/패인 시 현재 경로 유지 ----
bind c new-window -c "#{pane_current_path}"

# ---- 설정 리로드 ----
bind r source-file ~/.tmux.conf \; display "Config reloaded!"

# ---- Vi 모드 복사 ----
setw -g mode-keys vi
bind -T copy-mode-vi v send-keys -X begin-selection
bind -T copy-mode-vi y send-keys -X copy-pipe-and-cancel "pbcopy"

# ---- 상태바 ----
# set -g status-position top         # 상태바 상단

# ---- 플러그인 (tpm) ----
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-resurrect'
set -g @plugin 'tmux-plugins/tmux-continuum'
# set -g @plugin 'catppuccin/tmux#v2.1.3'
# set -g @catppuccin_flavor 'mocha'
# set -g @catppuccin_window_status_style 'rounded'
# set -g @catppuccin_window_current_text ' #W'
# set -g @catppuccin_window_text ' #W'
# set -g status-left ""
# set -g status-right "#{E:@catppuccin_status_directory}#{E:@catppuccin_status_session}"

set -g @plugin 'janoamaral/tokyo-night-tmux'

# Tokyo Night 테마 설정
set -g @tokyo-night-tmux_theme night
set -g @tokyo-night-tmux_show_path 1
set -g @tokyo-night-tmux_path_format relative

# continuum: 자동 저장/복원
set -g @continuum-restore 'on'

# tpm 초기화 (항상 맨 아래)
run '~/.tmux/plugins/tpm/tpm'

